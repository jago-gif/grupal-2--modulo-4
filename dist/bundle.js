(()=>{"use strict";function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,n(o.key),o)}}function r(t,e,r){return(e=n(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function n(e){var r=function(e,r){if("object"!==t(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,"string");if("object"!==t(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===t(r)?r:String(r)}var o=function(){function t(e,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._id=t.contador++,this._nombre=e,this._rut=r,t.empresas.push(this)}var r,n;return r=t,(n=[{key:"setId",set:function(t){this._id=t}},{key:"getId",get:function(){return this._id}},{key:"setNombre",set:function(t){this._nombre=t}},{key:"getNombre",value:function(){return this._nombre}},{key:"setRut",set:function(t){this._rut=t}},{key:"getRut",value:function(){return this._rut}},{key:"generarArray",value:function(){return t.empresas}},{key:"buscarPorId",value:function(e){for(var r=0;r<t.empresas.length;r++)if(t.empresas[r]._id===e)return t.empresas[r]._nombre}}])&&e(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),t}();function a(t){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a(t)}function i(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,u(n.key),n)}}function c(t,e,r){return(e=u(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function u(t){var e=function(t,e){if("object"!==a(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==a(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===a(e)?e:String(e)}r(o,"contador",0),r(o,"empresas",[]);var d=function(){function t(e,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._id=t.contador++,this._productos=e||[],this._idEmpresa=r,t.totalProductos.push(this._productos)}var e,r;return e=t,r=[{key:"setId",set:function(t){this._id=t}},{key:"getId",value:function(){return this._id}},{key:"setIdEmpresa",set:function(t){this._idEmpresa=t}},{key:"getIdEmpresa",get:function(){return this._idEmpresa}},{key:"setProductos",set:function(t){this._productos.push(t)}},{key:"getProductos",value:function(){return this._productos}},{key:"totalImportaciones",value:function(){return t.contador}},{key:"calcularTotal",value:function(){for(var e=0,r=0;r<t.totalProductos.length;r++)if(Array.isArray(t.totalProductos[r]))for(var n=0;n<t.totalProductos[r].length;n++)e+=t.totalProductos[r][n]._precio*t.totalProductos[r][n]._cantidad;else e+=t.totalProductos[r]._precio*t.totalProductos[r]._cantidad;return e}}],r&&i(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function l(t){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l(t)}function s(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,m(n.key),n)}}function m(t){var e=function(t,e){if("object"!==l(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==l(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===l(e)?e:String(e)}c(d,"contador",0),c(d,"totalProductos",[]);var f,y,p=function(){function t(e,r,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._id=t.contador++,this._nombre=e,this._precio=r,this._cantidad=n}var e,r;return e=t,r=[{key:"setId",set:function(t){this._id=t}},{key:"getId",value:function(){return this._id}},{key:"setNombre",set:function(t){this._nombre=t}},{key:"getNombre",value:function(){return this._nombre}},{key:"setPrecio",set:function(t){this._precio=t}},{key:"getPrecio",value:function(){return this._precio}},{key:"setCantidad",set:function(t){this._cantidad=t}},{key:"getCantidad",value:function(){return this._cantidad}}],r&&s(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function b(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return v(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?v(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,c=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return i=t.done,t},e:function(t){c=!0,a=t},f:function(){try{i||null==r.return||r.return()}finally{if(c)throw a}}}}function v(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}f=p,(y=m(y="contador"))in f?Object.defineProperty(f,y,{value:0,enumerable:!0,configurable:!0,writable:!0}):f[y]=0;var g,h=new p("papa",1e3,1),_=new p("peras",2e3,10),I=new o("EmpresaLinda","11.111.111-1"),E=[],w=[];E.push(I);var P,k=new d([h,_],I.getId);w.push(k),console.log(k);var S,B=0,j=0,T=document.getElementById("tablaEmpresas");function C(){for(var t="",e=0,r=E;e<r.length;e++){var n=r[e];t+="\n      <tr>\n      <td>".concat(n.getId,"</td>\n        <td>").concat(n.getNombre(),"</td>\n        <td>").concat(n.getRut(),"</td>\n      </tr>\n    ")}T.innerHTML=t}var O,A=document.getElementById("tablaImportaciones");function L(){for(var t="",e=0,r=w;e<r.length;e++){var n=r[e],o="",a="",i="";S=I.buscarPorId(n._idEmpresa);var c=n.getProductos();if(Array.isArray(c)){var u,d=b(n.getProductos());try{for(d.s();!(u=d.n()).done;){var l=u.value;o+=l.getPrecio()+"<br>",a+=l.getNombre()+"<br>",i+=l.getCantidad()+"<br>"}}catch(t){d.e(t)}finally{d.f()}t+="\n        <tr>\n        <td>".concat(n.getId(),"</td>\n          <td>").concat(S,"</td>\n          <td>").concat(i,"</td>\n          <td>").concat(a,"</td>\n          <td>").concat(o,"</td>\n        </tr>\n      ")}else o+=c.getPrecio()+"<br>",a+=c.getNombre()+"<br>",i+=c.getCantidad()+"<br>",t+="\n        <tr>\n        <td>".concat(n.getId(),"</td>\n          <td>").concat(S,"</td>\n          <td>").concat(i,"</td>\n          <td>").concat(a,"</td>\n          <td>").concat(o,"</td>\n        </tr>\n      ");A.innerHTML=t}}document.getElementById("agregarEmpresa").addEventListener("click",(function(t){t.preventDefault(),S=document.getElementById("nombre").value;var e=document.getElementById("rut").value;g=new o(S,e),E.push(g),document.getElementById("formEmpresa").reset(),C(),H(),$("#modalEmpresa").modal("hide")})),document.getElementById("agregarImportacion").addEventListener("click",(function(t){t.preventDefault();var e=parseInt(document.getElementById("idEmpresas").value),r=parseInt(document.getElementById("cantidad").value),n=document.getElementById("nombreProducto").value,o=parseInt(document.getElementById("valorProducto").value),a=new p(n,o,r),i=new d(a,e);w.push(i),document.getElementById("formImportacion").reset(),L(),$("#modalImportaciones").modal("hide"),x()})),$("#abrirModalEmpresa").click((function(){$("#modalEmpresa").modal("show")})),$("#abrirModalImportaciones").click((function(){!function(){(O=document.getElementById("idEmpresas")).innerHTML="";for(var t=0,e=E;t<e.length;t++){var r=e[t],n=document.createElement("option");n.value=r._id,n.text=r._nombre,O.add(n)}}(),$("#modalImportaciones").modal("show")}));var M=document.getElementById("totalValor"),N=document.getElementById("totalImportaciones");function x(){var t,e;t="".concat(k.totalImportaciones()),e="".concat(k.calcularTotal()),M.innerHTML=t,N.innerHTML=e}function H(){var t=-1;for((P=document.getElementById("dashBoard")).innerHTML="";t<E.length;t++){var e=document.createElement("option");-1===t?(e.value="",e.text="Seleccione una empresa",P.add(e)):(e.value=E[t]._id,e.text=E[t]._nombre,P.add(e))}}document.getElementById("dashBoard").addEventListener("change",(function(t){!function(){var t=document.getElementById("dashBoard").value;if(""===t)return void 0!==R&&R.destroy(),void(void 0!==D&&D.destroy());var e=[];B=0,j=0;for(var r=0,n=w;r<n.length;r++){var o=n[r];if(o._idEmpresa==t){var a=new p(o.getProductos());e.push(a)}}for(var i=0,c=e;i<c.length;i++){var u=c[i];if(j++,u._nombre.length>1){var d,l=b(u._nombre);try{for(l.s();!(d=l.n()).done;){var s=d.value;B=s._precio*s._cantidad+B}}catch(t){l.e(t)}finally{l.f()}}else B=u._nombre._precio*u._nombre._cantidad+B}for(var m=0,f=E;m<f.length;m++){var y=f[m];y._id==t&&(S=y._nombre)}(function(){void 0!==R&&R.destroy();var t=k.totalImportaciones()-j;R=new Chart(V,{type:"bar",data:{labels:[S,"Otras Empresas"],datasets:[{data:[j,t],label:"grafico de total de importaciones empresa",backgroundColor:["rgba(255, 99, 132, 0.2)","rgba(54, 162, 235, 0.2)"],borderColor:["rgba(255, 99, 132, 1)","rgba(54, 162, 235, 1)"],borderWidth:1}]},options:{responsive:!0}})})(),function(){void 0!==D&&D.destroy();var t=k.calcularTotal()-B;D=new Chart(W,{type:"bar",data:{labels:[S,"Otras Empresas"],datasets:[{label:"grafico de valor total de importaciones empresa",data:[B,t],backgroundColor:["rgba(255, 99, 132, 0.2)","rgba(54, 162, 235, 0.2)"],borderColor:["rgba(255, 99, 132, 1)","rgba(54, 162, 235, 1)"],borderWidth:1}]},options:{responsive:!0}})}(),console.log("total",B,"cantidad",j)}()}));var R,D,V=document.getElementById("tortaTotalImp").getContext("2d"),W=document.getElementById("tortaTotalValorImp").getContext("2d");H(),C(),L(),x()})();